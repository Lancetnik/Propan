# Pattern

**Pattern** Channel - мощный механизм маршрутизации *Redis*. Данный тип `channel` отправляет сообщения потребителям в соответсвии с *паттерном*,
указанном при их подключении к `channel` и ключом самого сообщения.

## Масштабирование

Если ключ сообщение совпадает с паттерном нескольких потребителей, оно будет отправлено **всем** им.
Таким образом, горизонтальное масштабирование путем увеличения количества сервисов-потребителей невозможно только средствами *Redis Pub/Sub*.

Если вам нужен подобный функционал, посмотрите в сторону *Redis Streams* или других брокеров (например, *Nats* или *RabbitMQ*).

## Пример

```python linenums="1"
{!> docs_src/redis/pattern.py !}
```

### Объявление потребителей

Для начала мы объявили несколько потребителей для двух каналов `*.info*` и `*.error`:

```python linenums="8" hl_lines="1 6 11"
{!> docs_src/redis/pattern.py [ln:8-20]!}
```

!!! note
    Обратите внимание, что `handler1` и `handler2` подписаны на один `channel`:
    cообщения будут приходить оба этих обработчика.

### Распределение сообщений

Теперь распределение сообщений между этими потребителями будет выглядеть следующим образом:

```python
{!> docs_src/redis/pattern.py [ln:25]!}
```

Сообщение `1` будет отправлено в `handler1` и `handler2`, т.к. они слушают `channel` с паттерном `*.info*`

---

```python
{!> docs_src/redis/pattern.py [ln:26]!}
```

Сообщение `2` будет отправлено в `handler3`, т.к. он слушает `channel` с паттерном `*.error`
