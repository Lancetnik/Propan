# Direct

**Direct** Channel - базовый способ маршрутизации сообщений в *Redis*. Его суть очень проста:
`channel` отправляет сообщения всем потребителям, подписанным на него.

## Масштабирование

Если один канал слушает несколько потребителей, сообщение будет получено **всеми** потребителями этого канала.
Таким образом, горизонтальное масштабирование путем увеличения количества сервисов-потребителей невозможно только средствами *Redis Pub/Sub*.

Если вам нужен подобный функционал, посмотрите в сторону *Redis Streams* или других брокеров (например, *Nats* или *RabbitMQ*).

## Пример

**Direct** Channel - тип, используемый в **Propan** по умолчанию: вы можете просто объявить его следующим образом

```python
@broker.handler("test_channel")
async def handler():
    ...
```

Полный пример:

```python linenums="1"
{!> docs_src/redis/direct.py !}
```

### Объявление потребителей

Для начала мы объявили несколько потребителей для двух каналов `test` и `test2`:

```python linenums="8" hl_lines="1 6 11"
{!> docs_src/redis/direct.py [ln:8-20]!}
```

!!! note
    Обратите внимание, что `handler1` и `handler2` подписаны на один `channel`:
    cообщения будут приходить оба этих обработчика.

### Распределение сообщений

Теперь распределение сообщений между этими потребителями будет выглядеть следующим образом:

```python
{!> docs_src/redis/direct.py [ln:25]!}
```

Сообщение `1` будет отправлено в `handler1` и `handler2`, т.к. они слушают `channel` с названием `test`

---

```python
{!> docs_src/redis/direct.py [ln:26]!}
```

Сообщение `2` будет отправлено в `handler3`, т.к. он слушает `channel` с названием `test2`
